/*! leeven 2015-02-08 */
!function(a){function b(){var b=a("#formProject").data("method"),c=a("#formProject").data("teamid");"post"!==b&&(c=a("#formProject").data("pid")),a.myAjax({type:b,url:"/projects/"+c,data:a("#formProject").serialize(),beforeSend:function(){a("#btnAddProject").addClass("loading")},success:function(b){b.status?window.location.reload():a(".msg-project-form").html(a.errMsg(b.result)).show()},error:function(){a(".msg-project-form").text("提交失败，请稍后重试").show()},complete:function(){a("#btnAddProject").removeClass("loading")}})}if(a(".page-projects").length){a("#btnAddProject").on("click",function(){a(".sidebar-project .header").text("新增项目"),a("#formProject").data("method","post"),a(".del-project").css("display","none"),a(".sidebar-project").sidebar({overlay:!0}).sidebar("show")}),a(".setting-project").on("click",function(){var b=a(this);a(".sidebar-project .header").text("编辑项目"),a("#formProject").data("method","put"),a('#formProject input[name="name"]').val(b.prev().find(".title").text()),a('#formProject textarea[name="description"]').val(b.prev().find(".description").text()),a("#formProject").data("pid",b.data("pid")),a(".del-project").css("display","block"),a(".sidebar-project").sidebar({overlay:!0}).sidebar("show")}),a(".del-project").on("click",function(){confirm("本操作将删除该项目及以下的所有文档，确认删除？")&&(a("#formProject").data("method","delete"),b())});var c={name:{identifier:"name",rules:[{type:"empty",prompt:"请输入项目名称"}]}};a("#formProject").form(c,{onSuccess:function(){return b(),!1},onFailure:function(){return!1}})}}(window.jQuery);