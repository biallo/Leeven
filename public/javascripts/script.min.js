/*! leeven 2014-09-12 */
!function(a){function b(){var b=a("#formProject").data("method"),c=a("#formProject").data("groupid");"post"!==b&&(c=a("#formProject").data("pid")),a.myAjax({type:b,url:"/projects/"+c,data:a("#formProject").serialize(),beforeSend:function(){a("#btnAddProject").addClass("loading")},success:function(b){b.status?window.location.reload():a(".msg-project-form").html(a.errMsg(b.result)).show()},error:function(){a(".msg-project-form").text("提交失败，请稍后重试").show()},complete:function(){a("#btnAddProject").removeClass("loading")}})}if(a(".page-projects").length){a("#btnAddProject").on("click",function(){a(".sidebar-project .header").text("新增项目"),a("#formProject").data("method","post"),a(".del-project").css("display","none"),a(".sidebar-project").sidebar({overlay:!0}).sidebar("show")}),a(".setting-project").on("click",function(){var b=a(this);a(".sidebar-project .header").text("编辑项目"),a("#formProject").data("method","put"),a('#formProject input[name="name"]').val(b.prev().find(".title").text()),a('#formProject textarea[name="description"]').val(b.prev().find(".description").text()),a("#formProject").data("pid",b.data("pid")),a(".del-project").css("display","block"),a(".sidebar-project").sidebar({overlay:!0}).sidebar("show")}),a(".del-project").on("click",function(){confirm("本操作将删除该项目及以下的所有文档，确认删除？")&&(a("#formProject").data("method","delete"),b())});var c={name:{identifier:"name",rules:[{type:"empty",prompt:"请输入项目名称"}]}};a("#formProject").form(c,{onSuccess:function(){return b(),!1},onFailure:function(){return!1}})}}(window.jQuery),function(a){function b(){var b=a("#formFile").data("method"),c=a("#formFile").data("pid");"post"!==b&&(c=a("#formFile").data("fid")),a.myAjax({type:b,url:"/files/"+c,data:a("#formFile").serialize(),beforeSend:function(){a("#btnAddFile").addClass("loading")},success:function(b){b.status?window.location.reload():a(".msg-file-form").html(a.errMsg(b.result)).show()},error:function(){a(".msg-file-form").text("提交失败，请稍后重试").show()},complete:function(){a("#btnAddFile").removeClass("loading")}})}if(a(".page-files").length){a("#btnAddFile").on("click",function(){a(".sidebar-file .header").text("新增文档"),a("#formFile").data("method","post"),a(".del-file").css("display","none"),a(".sidebar-file").sidebar({overlay:!0}).sidebar("show")}),a(".setting-file").on("click",function(){var b=a(this);a(".sidebar-file .header").text("编辑文档"),a("#formFile").data("method","put"),a('#formFile input[name="name"]').val(b.parent().prev().find(".title").text()),a("#formFile").data("fid",b.data("fid")),a(".del-file").css("display","block"),a(".sidebar-file").sidebar({overlay:!0}).sidebar("show")}),a(".del-file").on("click",function(){confirm("确定要删除该文档？")&&(a("#formFile").data("method","delete"),b())});var c={name:{identifier:"name",rules:[{type:"empty",prompt:"请输入文档名称"}]}};a("#formFile").form(c,{onSuccess:function(){return b(),!1},onFailure:function(){return!1}})}}(window.jQuery),function(a){function b(){var b=marked(f.session.getValue());a(".preview").html(b),f.session.getUndoManager().markClean()}function c(){a.myAjax({type:"put",url:"/editfile/"+a("#editor").data("fid"),data:{content:f.session.getValue()},beforeSend:function(){a("#btnSaveFile").addClass("loading")},success:function(a){d(a.result.msg)},error:function(){d("提交失败，请稍后重试")},complete:function(){a("#btnSaveFile").removeClass("loading")}})}function d(b){clearTimeout(e.timer),a(".editor-msg").text(b),e.timer=setTimeout(function(){a(".editor-msg").transition("flash",function(){a(this).text("")})},3e3)}if(a(".page-edit-file").length){var e={timer:""},f=ace.edit(a("#editor")[0]);f.setTheme("ace/theme/monokai"),f.setFontSize("16px"),f.getSession().setUseWrapMode(!0),f.getSession().setMode("ace/mode/markdown"),f.setAnimatedScroll(!0),f.setHighlightActiveLine(!0),f.renderer.setShowGutter(!0),f.setReadOnly(!1),f.setBehavioursEnabled(!0),f.setHighlightSelectedWord(!0),f.setAnimatedScroll(!0),f.setShowInvisibles(!1),f.setSelectionStyle("text"),f.getSession().setUseWorker(!0),f.session.setValue(a("#editor").data("content"),-1),b(),f.commands.addCommand({name:"saveCommand",bindKey:{win:"Ctrl-s",mac:"Command-s"},exec:function(){c()},readOnly:!1}),f.getSession().on("change",function(){var a=f.session.getUndoManager().isClean();a||b()}),a("#btnSaveFile").on("click",function(){c()})}}(window.jQuery),function(a){if(a(".page-view-file").length){var b=marked(a(".file-content").data("md"));a(".file-content").html(b)}}(window.jQuery);
/*! leeven 最后修改于： 2014-09-12 */